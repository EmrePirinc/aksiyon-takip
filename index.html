<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aksiyon Takip Sistemi - Anadolu Bakƒ±r & AIFTEAM</title>
    <!-- Excel (SheetJS) K√ºt√ºphanesi -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Word'e Aktarma K√ºt√ºphaneleri -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/html-docx-js@0.4.1/dist/html-docx.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>üöÄ Aksiyon Takip</h1>
                <p class="login-subtitle">Projelerinizi profesyonelce y√∂netin</p>
            </div>
            <form id="loginForm" onsubmit="event.preventDefault(); signIn();">
                <div class="form-group">
                    <label for="email">E-posta</label>
                    <input type="email" id="email" placeholder="ornek@email.com" required>
                </div>
                <div class="form-group">
                    <label for="password">≈ûifre</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <div class="remember-me">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">Beni hatƒ±rla</label>
                </div>
                 <div class="form-group" style="margin-top: 25px;">
                    <button type="submit">Sisteme Giri≈ü Yap</button>
                </div>
                <div id="login-error"></div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-container" style="display: none;">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="header-content">
                    <div class="header-title">
                        <h1>üöÄ Aksiyon Takip Sistemi</h1>
                    </div>
                    <div class="header-controls">
                        <div class="user-info">
                            <span id="currentUser">Kullanƒ±cƒ±</span>
                        </div>
                        <button class="header-btn" onclick="openPersonModal()">üë• Ki≈üi Y√∂netimi</button>
                        <button class="header-btn danger" onclick="signOut()">üö™ √áƒ±kƒ±≈ü Yap</button>
                    </div>
                </div>
            </div>

            <!-- Team Statistics -->
            <div class="stats-row">
                <div class="team-stats anadolu-stats">
                    <h3><span style="font-size: 1.5rem;">üè¢</span> Anadolu Bakƒ±r</h3>
                    <div class="stats-grid">
                        <div class="mini-stat"><div class="label">Toplam</div><div class="value" id="anadoluTotal">0</div></div>
                        <div class="mini-stat"><div class="label">Bekleyen</div><div class="value" id="anadoluWaiting">0</div></div>
                        <div class="mini-stat"><div class="label">Devam Eden</div><div class="value" id="anadoluInProgress">0</div></div>
                        <div class="mini-stat"><div class="label">Tamamlanan</div><div class="value" id="anadoluCompleted">0</div></div>
                    </div>
                </div>
                <div class="team-stats aifteam-stats">
                    <h3><span style="font-size: 1.5rem;">üíª</span> AIFTEAM</h3>
                    <div class="stats-grid">
                        <div class="mini-stat"><div class="label">Toplam</div><div class="value" id="aifteamTotal">0</div></div>
                        <div class="mini-stat"><div class="label">Bekleyen</div><div class="value" id="aifteamWaiting">0</div></div>
                        <div class="mini-stat"><div class="label">Devam Eden</div><div class="value" id="aifteamInProgress">0</div></div>
                        <div class="mini-stat"><div class="label">Tamamlanan</div><div class="value" id="aifteamCompleted">0</div></div>
                    </div>
                </div>
                <div class="team-stats ortak-stats">
                    <h3><span style="font-size: 1.5rem;">ü§ù</span> Ortak Aksiyonlar</h3>
                    <div class="stats-grid">
                        <div class="mini-stat"><div class="label">Toplam</div><div class="value" id="ortakTotal">0</div></div>
                        <div class="mini-stat"><div class="label">Bekleyen</div><div class="value" id="ortakWaiting">0</div></div>
                        <div class="mini-stat"><div class="label">Devam Eden</div><div class="value" id="ortakInProgress">0</div></div>
                        <div class="mini-stat"><div class="label">Tamamlanan</div><div class="value" id="ortakCompleted">0</div></div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls-section">
                <div class="controls-top">
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="teamFilter">Takƒ±m:</label>
                            <select id="teamFilter" onchange="filterActions()">
                                <option value="">T√ºm√º</option>
                                <option value="anadolu">Anadolu Bakƒ±r</option>
                                <option value="aifteam">AIFTEAM</option>
                                <option value="ortak">Ortak</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="statusFilter">Durum:</label>
                            <select id="statusFilter" onchange="filterActions()">
                                <option value="">T√ºm√º</option>
                                <option value="waiting">Bekleyen</option>
                                <option value="inprogress">Devam Eden</option>
                                <option value="completed">Tamamlanan</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="dateFilter">Tarihe g√∂re sƒ±rala:</label>
                            <select id="dateFilter" onchange="filterActions()">
                                <option value="asc">En yakƒ±n tarih</option>
                                <option value="desc">En uzak tarih</option>
                            </select>
                        </div>
                        <button class="filter-btn" id="priorityFilterBtn" onclick="togglePriorityFilter()">‚≠ê √ñncelikli</button>
                    </div>
                     <div class="filter-group view-toggle" style="margin-left: auto;">
                        <button class="view-btn filter-btn active" data-view="grouped">Gruplu</button>
                        <button class="view-btn filter-btn" data-view="list">Liste</button>
                        <button class="view-btn filter-btn" data-view="calendar">Takvim</button>
                    </div>
                </div>

                <div class="controls-bottom">
                    <button class="primary-btn" onclick="openModal()">
                        ‚ûï Yeni Aksiyon Ekle
                    </button>
                    <button class="primary-btn" onclick="exportToExcel()" style="background: #10b981;">üìä Excel ƒ∞ndir</button>
                    <button class="primary-btn" onclick="exportToWord()" style="background: #3b82f6;">üìÑ Word ƒ∞ndir</button>
                </div>
            </div>

            <!-- Actions Container -->
            <div class="actions-container">
                <div id="actionsContainerGrouped" class="actions-view-container active"></div>
                <div id="actionsContainerList" class="actions-view-container"></div>
                <div id="actionsContainerKanban" class="actions-view-container"></div>
                <div id="actionsContainerCalendar" class="actions-view-container"></div>
                <div id="noResults" class="actions-view-container" style="text-align: center; color: var(--gray-500); padding: var(--space-8);"></div>
            </div>
        </div>
    </div>

    <!-- Action Modal -->
    <div id="actionModal" class="modal" onclick="closeModalOnOutsideClick(event)">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Yeni Aksiyon Ekle</h2>
            </div>
            <div class="modal-body">
                <form id="actionForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="actionTitle">Ba≈ülƒ±k *</label>
                            <input type="text" id="actionTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="actionResponsible">Sorumlu Takƒ±m *</label>
                            <select id="actionResponsible" required>
                                <option value="">Se√ßiniz</option>
                                <option value="anadolu">Anadolu Bakƒ±r</option>
                                <option value="aifteam">AIFTEAM</option>
                                <option value="ortak">Ortak</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="actionPerson">Ki≈üi</label>
                            <select id="actionPerson">
                                <option value="">Se√ßiniz</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="actionDate">Hedef Tarih *</label>
                            <input type="date" id="actionDate" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="actionDescription">A√ßƒ±klama</label>
                        <textarea id="actionDescription" placeholder="Aksiyonun detaylarƒ±nƒ± yazƒ±nƒ±z..."></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="actionStatus">Durum</label>
                            <select id="actionStatus">
                                <option value="waiting">Bekleyen</option>
                                <option value="inprogress">Devam Eden</option>
                                <option value="completed">Tamamlanan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="actionPriority">
                                <input type="checkbox" id="actionPriority" style="margin-right: 8px;">
                                √ñncelikli Aksiyon
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn" onclick="closeModal()">ƒ∞ptal</button>
                <button type="button" class="btn primary" onclick="saveAction()">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Person Modal -->
    <div id="personModal" class="modal" onclick="closeModalOnOutsideClick(event)">
        <div class="modal-content">
            <div class="modal-header"><h2>Ki≈üi Y√∂netimi</h2></div>
            <div id="personListContainer"></div>
            <hr style="margin: 20px -32px; border: none; border-top: 1px solid var(--gray-200);">
            <h3 style="margin-bottom: 20px;">Yeni Ki≈üi Ekle</h3>
            <form id="addPersonForm" style="margin-bottom: 20px;">
                <div class="form-group">
                    <label for="personName">ƒ∞sim Soyisim</label>
                    <input type="text" id="personName" required>
                </div>
                <div class="form-group">
                    <label for="personEmail">E-posta</label>
                    <input type="email" id="personEmail">
                </div>
                <div class="form-group">
                    <label for="personTeam">Takƒ±m</label>
                    <select id="personTeam" required>
                        <option value="">Se√ßiniz</option>
                        <option value="anadolu">Anadolu Bakƒ±r</option>
                        <option value="aifteam">AIFTEAM</option>
                        <option value="ortak">Ortak</option>
                    </select>
                </div>
                <button type="button" class="btn primary" onclick="addPerson()">Ki≈üi Ekle</button>
            </form>
            <div style="text-align: center;">
                <button type="button" class="btn" onclick="closePersonModal()">Kapat</button>
            </div>
        </div>
    </div>

    <!-- Postpone Modal -->
    <div id="postponeModal" class="modal" onclick="closeModalOnOutsideClick(event)">
        <div class="modal-content">
            <div class="modal-header"><h2>Aksiyonu Ertele</h2></div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="postponeReason">Erteleme Nedeni</label>
                    <textarea id="postponeReason" placeholder="Neden ertelendiƒüini a√ßƒ±klayƒ±nƒ±z..." required></textarea>
                </div>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn" onclick="closePostponeModal()">ƒ∞ptal</button>
                <button type="button" class="btn primary" onclick="confirmPostpone()">Ertele</button>
            </div>
        </div>
    </div>

    <!-- Detail View Modal -->
    <div id="detailModal" class="modal" onclick="closeModalOnOutsideClick(event)">
        <div class="modal-content">
            <div class="modal-header"><h2>Aksiyon Detaylarƒ±</h2></div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div class="detail-label">Ba≈ülƒ±k</div><div class="detail-value" id="detailTitle"></div>
                    <div class="detail-label">Sorumlu</div><div class="detail-value" id="detailResponsible"></div>
                    <div class="detail-label">Ki≈üi</div><div class="detail-value" id="detailPerson"></div>
                    <div class="detail-label">Durum</div><div class="detail-value" id="detailStatus"></div>
                    <div class="detail-label">Hedef Tarih</div><div class="detail-value" id="detailDate"></div>
                    <div class="detail-label" id="detailPostponeLabel" style="display: none;">Erteleme Notu</div><div class="detail-value" id="detailPostponeNote" style="display: none;"></div>
                </div>
                <div class="detail-label" style="margin-bottom: var(--space-2);">A√ßƒ±klama</div>
                <p id="detailDescription"></p>
            </div>
            <div class="modal-buttons">
                <button type="button" class="btn" onclick="closeDetailModal()">Kapat</button>
                <button type="button" class="btn primary" onclick="editFromDetail()">D√ºzenle</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyC8rLJhqF_kP3a2C5OT7r5S0Dn6cNRgHvw",
            authDomain: "aksiyon-takip-2024.firebaseapp.com",
            projectId: "aksiyon-takip-2024",
            storageBucket: "aksiyon-takip-2024.firebasestorage.app",
            messagingSenderId: "1016969499265",
            appId: "1:1016969499265:web:9d3a3f8b3a9a4e2f3b8e9c"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.auth = auth;
        window.db = db;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.collection = collection;
        window.doc = doc;
        window.updateDoc = updateDoc;
        window.deleteDoc = deleteDoc;
        window.query = query;
        window.orderBy = orderBy;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signOut = signOut;

        const loginContainer = document.getElementById('login-container');
        const appContainer = document.getElementById('app-container');

        auth.onAuthStateChanged((user) => {
            if (user) {
                loginContainer.style.display = 'none';
                document.body.style.background = 'var(--gray-50)';
                appContainer.style.display = 'block';

                const email = user.email || 'Kullanƒ±cƒ±';
                const cleanEmail = email.split('@')[0];
                const formattedEmail = cleanEmail.charAt(0).toUpperCase() + cleanEmail.slice(1);
                document.getElementById('currentUser').textContent = `üëã ${formattedEmail}`;

                loadActions();
                loadPersons();
            } else {
                loginContainer.style.display = 'flex';
                appContainer.style.display = 'none';
                document.body.style.background = 'linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%)';
            }
        });
    </script>

    <script>
        // Global Variables
        let actions = [];
        let persons = [];
        let editingId = null;
        let postponingId = null;
        let currentView = 'grouped';
        let activeFilters = {
            team: '',
            status: '',
            priority: false,
            dateSort: 'asc'
        };

        // Icons
        const ICONS = {
            edit: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>`,
            delete: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3,6 5,6 21,6"></polyline><path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>`,
            postpone: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>`
        };

        // Toast Function
        function showToast(message, type = 'success') {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.toast-notification');
            existingToasts.forEach(toast => toast.remove());

            // Create toast
            const toast = document.createElement('div');
            toast.className = `toast-notification ${type}`;
            toast.textContent = message;

            // Toast notification CSS'i ekle
            if (!document.querySelector('#toast-styles')) {
                const toastStyles = document.createElement('style');
                toastStyles.id = 'toast-styles';
                toastStyles.textContent = `
                    .toast-notification {
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        padding: 16px 24px;
                        border-radius: 8px;
                        color: white;
                        font-weight: 500;
                        z-index: 10000;
                        animation: slideIn 0.3s ease;
                        max-width: 400px;
                        word-wrap: break-word;
                    }
                    .toast-notification.success {
                        background: #10b981;
                    }
                    .toast-notification.error {
                        background: #ef4444;
                    }
                    .toast-notification.info {
                        background: #3b82f6;
                    }
                    @keyframes slideIn {
                        from {
                            transform: translateX(100%);
                            opacity: 0;
                        }
                        to {
                            transform: translateX(0);
                            opacity: 1;
                        }
                    }
                `;
                document.head.appendChild(toastStyles);
            }

            document.body.appendChild(toast);

            // Auto remove after 3 seconds
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Auth Functions
        async function signIn() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('login-error');

            try {
                await signInWithEmailAndPassword(auth, email, password);
                showToast('Ba≈üarƒ±yla giri≈ü yapƒ±ldƒ±!', 'success');
            } catch (error) {
                console.error('Login error:', error);
                errorDiv.textContent = 'Giri≈ü ba≈üarƒ±sƒ±z. E-posta ve ≈üifrenizi kontrol edin.';
                showToast('Giri≈ü ba≈üarƒ±sƒ±z!', 'error');
            }
        }

        async function signOut() {
            try {
                await auth.signOut();
                showToast('Ba≈üarƒ±yla √ßƒ±kƒ±≈ü yapƒ±ldƒ±!', 'info');
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // Modal Functions
        function openPostponeModal(actionId) {
            postponingId = actionId;
            document.getElementById('postponeReason').value = '';
            const modal = document.getElementById('postponeModal');
            modal.classList.add('active');
            modal.style.display = 'flex';
        }

        function closePostponeModal() {
            const modal = document.getElementById('postponeModal');
            modal.classList.remove('active');
            modal.style.display = 'none';
            postponingId = null;
        }

        function confirmPostpone() {
            const reason = document.getElementById('postponeReason').value.trim();
            if (!reason) {
                showToast('L√ºtfen erteleme nedenini giriniz.', 'error');
                return;
            }
            postponeAction(postponingId, reason);
            closePostponeModal();
        }

        // View Functions
        function switchView(view) {
            currentView = view;

            // Update active button
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-view="${view}"]`).classList.add('active');

            // Hide all containers
            document.querySelectorAll('.actions-view-container').forEach(c => {
                c.classList.remove('active');
                c.style.display = 'none';
            });

            // Check if there are filtered actions
            const filteredActions = getFilteredActions();
            if (filteredActions.length === 0) {
                 const noResultsEl = document.getElementById('noResults');
                 noResultsEl.innerHTML = `<p>Bu filtreler ile e≈üle≈üen aksiyon bulunamadƒ±.</p>`;
                 noResultsEl.classList.add('active');
                 noResultsEl.style.display = 'block';
                 return;
            }

            // Show appropriate container
            const containerElement = document.getElementById(`actionsContainer${view.charAt(0).toUpperCase() + view.slice(1)}`);
            if (containerElement) {
                containerElement.classList.add('active');
                containerElement.style.display = 'block';

                switch(currentView) {
                    case 'grouped':
                        renderGroupedActions(filteredActions);
                        break;
                    case 'list':
                        renderListActions(filteredActions);
                        break;
                    case 'kanban':
                        renderKanbanActions(filteredActions);
                        break;
                    case 'calendar':
                        renderCalendarActions(filteredActions);
                        break;
                }
            }
        }

        // Add event listeners for view buttons
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    switchView(btn.dataset.view);
                });
            });
        });

        // Action Card Functions
        function createActionCard(action) {
            const { id, title, responsible, person, status, date, description, priority, postponed, postponeReason } = action;

            const teamType = getTeamType(responsible);
            const isOverdue = date && new Date(date) < new Date() && status !== 'completed';
            const personName = getPersonName(person);

            return `
                <div class="action-card ${teamType} ${postponed ? 'postponed' : ''}" draggable="true" data-action-id="${id}" ondragstart="drag(event, '${id}')">
                    <div class="action-header" onclick="openDetailView('${id}')" style="cursor: pointer;">
                        <div class="action-title-block">
                            <div class="action-title">${priority ? '‚≠ê ' : ''}${title || 'Ba≈ülƒ±ksƒ±z Aksiyon'}</div>
                            <div class="action-responsible">${getTeamDisplayName(responsible)}</div>
                        </div>
                        ${personName ? `<div class="action-person">${personName}</div>` : ''}
                    </div>

                    <div class="action-body" onclick="openDetailView('${id}')" style="cursor: pointer;">
                         ${postponed ? `<div class="update-box"><strong>Ertelendi:</strong> ${postponeReason || ''}</div>` : ''}
                        <div class="action-description">${description || 'A√ßƒ±klama yok'}</div>
                    </div>

                    <div class="action-footer">
                        <div class="date ${isOverdue ? 'overdue' : ''}" onclick="openDetailView('${id}')" style="cursor: pointer;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                            <span>${date ? formatDate(date) : "Tarih Yok"}</span>
                        </div>
                        <div class="action-buttons">
                           <button class="action-btn" data-action="edit" data-action-id="${id}" title="D√ºzenle">${ICONS.edit}</button>
                           <button class="action-btn" data-action="postpone" data-action-id="${id}" title="Ertele">${ICONS.postpone}</button>
                           <button class="action-btn" data-action="delete" data-action-id="${id}" title="Sil">${ICONS.delete}</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event Delegation for Action Buttons
        document.addEventListener('click', function(e) {
            if (e.target.closest('.action-btn')) {
                e.stopPropagation();
                const btn = e.target.closest('.action-btn');
                const action = btn.dataset.action;
                const actionId = btn.dataset.actionId;

                switch(action) {
                    case 'edit':
                        editAction(actionId);
                        break;
                    case 'delete':
                        if (confirm('Bu aksiyonu silmek istediƒüinizden emin misiniz?')) {
                            deleteAction(actionId);
                        }
                        break;
                    case 'postpone':
                        openPostponeModal(actionId);
                        break;
                }
            }
        });

        // Utility Functions
        function getTeamType(responsible) {
            const teamMap = {
                'anadolu': 'anadolu',
                'aifteam': 'aifteam',
                'ortak': 'ortak'
            };
            return teamMap[responsible] || 'ortak';
        }

        function getTeamDisplayName(responsible) {
            const teamMap = {
                'anadolu': 'Anadolu Bakƒ±r',
                'aifteam': 'AIFTEAM',
                'ortak': 'Ortak'
            };
            return teamMap[responsible] || 'Bilinmeyen';
        }

        function getPersonName(personId) {
            if (!personId) return '';
            const person = persons.find(p => p.id === personId);
            return person ? person.name : '';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('tr-TR');
        }

        function getStatusText(status) {
            const statusMap = {
                'waiting': 'Bekleyen',
                'inprogress': 'Devam Eden',
                'completed': 'Tamamlanan'
            };
            return statusMap[status] || 'Bilinmeyen';
        }

        // Modal Functions
        function openModal() {
            clearForm();
            document.getElementById('modalTitle').textContent = 'Yeni Aksiyon Ekle';
            editingId = null;
            const modal = document.getElementById("actionModal");
            modal.classList.add("active");
            modal.style.display = "flex";
        }

        function closeModal() {
            const modal = document.getElementById("actionModal");
            modal.classList.remove("active");
            modal.style.display = "none";
            editingId = null;
        }

        function clearForm() {
            document.getElementById("actionForm").reset();
            document.getElementById("actionPriority").checked = false;
        }

        function editAction(actionId) {
            const action = actions.find(a => a.id === actionId);
            if (!action) return;

            editingId = actionId;
            document.getElementById('modalTitle').textContent = 'Aksiyonu D√ºzenle';

            document.getElementById('actionTitle').value = action.title || '';
            document.getElementById('actionResponsible').value = action.responsible || '';
            document.getElementById('actionPerson').value = action.person || '';
            document.getElementById('actionDate').value = action.date || '';
            document.getElementById('actionDescription').value = action.description || '';
            document.getElementById('actionStatus').value = action.status || 'waiting';
            document.getElementById('actionPriority').checked = action.priority || false;

            updatePersonOptions();

            const modal = document.getElementById("actionModal");
            modal.classList.add("active");
            modal.style.display = "flex";

            console.log('Edit modal opened for action:', action.title);
        }

        function openDetailView(actionId) {
            const action = actions.find(a => a.id === actionId);
            if (!action) return;

            document.getElementById('detailTitle').textContent = action.title || 'Ba≈ülƒ±ksƒ±z';
            document.getElementById('detailResponsible').textContent = getTeamDisplayName(action.responsible);
            document.getElementById('detailPerson').textContent = getPersonName(action.person) || 'Belirtilmemi≈ü';
            document.getElementById('detailStatus').innerHTML = `<span class="status-badge ${action.status}">${getStatusText(action.status)}</span>`;
            document.getElementById('detailDate').textContent = action.date ? formatDate(action.date) : 'Belirtilmemi≈ü';
            document.getElementById('detailDescription').textContent = action.description || 'A√ßƒ±klama yok';

            const postponeLabel = document.getElementById('detailPostponeLabel');
            const postponeNote = document.getElementById('detailPostponeNote');
            if (action.postponed && action.postponeReason) {
                postponeLabel.style.display = 'block';
                postponeNote.style.display = 'block';
                postponeNote.innerHTML = `<div class="postpone-note">${action.postponeReason}</div>`;
            } else {
                postponeLabel.style.display = 'none';
                postponeNote.style.display = 'none';
            }

            const modal = document.getElementById('detailModal');
            modal.classList.add('active');
            modal.style.display = 'flex';
        }

        function closeDetailModal() {
            const modal = document.getElementById('detailModal');
            modal.classList.remove('active');
            modal.style.display = 'none';
        }

        function editFromDetail() {
            const actionId = getCurrentDetailActionId();
            closeDetailModal();
            editAction(actionId);
        }

        function getCurrentDetailActionId() {
            // This is a helper function to get the current action ID from the detail modal
            // In a real implementation, you might store this when opening the modal
            return null; // You'll need to implement this properly
        }

        // List View Functions
        function renderListActions(actionsToRender) {
            const container = document.getElementById('actionsContainerList');

            let html = `
                <div class="list-container">
                    <div class="list-header">
                        <div>Ba≈ülƒ±k</div>
                        <div>Sorumlu</div>
                        <div>Ki≈üi</div>
                        <div>Durum</div>
                        <div>Tarih</div>
                        <div>ƒ∞≈ülemler</div>
                    </div>
            `;

            actionsToRender.forEach(action => {
                const personName = getPersonName(action.person) || 'Belirtilmemi≈ü';
                const teamType = getTeamType(action.responsible);
                html += `
                    <div class="list-item" style="border-left: 5px solid var(--${teamType});">
                        <div class="title" onclick="openDetailView('${action.id}')" style="cursor: pointer;">${action.priority ? '‚≠ê ' : ''}${action.title}</div>
                        <div class="responsible" onclick="openDetailView('${action.id}')" style="cursor: pointer;">${action.responsible}</div>
                        <div class="person" onclick="openDetailView('${action.id}')" style="cursor: pointer;">${personName}</div>
                        <div class="status"><span class="status-badge ${action.status}" onclick="event.stopPropagation(); quickStatusChange('${action.id}', '${action.status}')">${getStatusText(action.status)}</span></div>
                        <div class="date" onclick="openDetailView('${action.id}')" style="cursor: pointer;">${action.date ? formatDate(action.date) : '-'}</div>
                        <div class="actions action-buttons">
                           <button class="action-btn" data-action="edit" data-action-id="${action.id}" title="D√ºzenle">${ICONS.edit}</button>
                           <button class="action-btn" data-action="postpone" data-action-id="${action.id}" title="Ertele">${ICONS.postpone}</button>
                           <button class="action-btn" data-action="delete" data-action-id="${action.id}" title="Sil">${ICONS.delete}</button>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function quickStatusChange(actionId, currentStatus) {
            const statusOrder = ['waiting', 'inprogress', 'completed'];
            const currentIndex = statusOrder.indexOf(currentStatus);
            const nextIndex = (currentIndex + 1) % statusOrder.length;
            const newStatus = statusOrder[nextIndex];

            updateActionStatus(actionId, newStatus);
        }

        async function updateActionStatus(actionId, newStatus) {
            try {
                const actionRef = doc(db, 'actions', actionId);
                await updateDoc(actionRef, {
                    status: newStatus,
                    updatedAt: new Date()
                });

                await loadActions();
                showToast('Durum g√ºncellendi!', 'success');
            } catch (error) {
                console.error('Error updating status:', error);
                showToast('Durum g√ºncellenirken hata olu≈ütu!', 'error');
            }
        }

        // Kanban, Calendar, and other view functions would go here...
        function renderKanbanActions(actionsToRender) {
            // Kanban implementation
        }

        function renderCalendarActions(actionsToRender) {
            // Calendar implementation
        }

        function renderGroupedActions(actionsToRender) {
            const container = document.getElementById('actionsContainerGrouped');

            const anadoluActions = actionsToRender.filter(a => a.responsible === 'anadolu');
            const aifteamActions = actionsToRender.filter(a => a.responsible === 'aifteam');
            const ortakActions = actionsToRender.filter(a => a.responsible === 'ortak');

            let html = '<div class="kanban-container">';

            // Anadolu Bakƒ±r column
            html += `
                <div class="kanban-column" data-team="anadolu">
                    <div class="kanban-header">
                        <span class="kanban-title">üè¢ Anadolu Bakƒ±r</span>
                        <span class="kanban-count">${anadoluActions.length}</span>
                    </div>
                    <div class="kanban-cards">
                        ${anadoluActions.map(action => createActionCard(action)).join('')}
                    </div>
                </div>
            `;

            // AIFTEAM column
            html += `
                <div class="kanban-column" data-team="aifteam">
                    <div class="kanban-header">
                        <span class="kanban-title">üíª AIFTEAM</span>
                        <span class="kanban-count">${aifteamActions.length}</span>
                    </div>
                    <div class="kanban-cards">
                        ${aifteamActions.map(action => createActionCard(action)).join('')}
                    </div>
                </div>
            `;

            // Ortak column
            html += `
                <div class="kanban-column" data-team="ortak">
                    <div class="kanban-header">
                        <span class="kanban-title">ü§ù Ortak</span>
                        <span class="kanban-count">${ortakActions.length}</span>
                    </div>
                    <div class="kanban-cards">
                        ${ortakActions.map(action => createActionCard(action)).join('')}
                    </div>
                </div>
            `;

            html += '</div>';
            container.innerHTML = html;
        }

        // Person Management Functions
        function openPersonModal() {
            loadPersonList();
            const modal = document.getElementById('personModal');
            if (modal) {
                modal.classList.add('active');
                modal.style.display = 'flex';
            } else {
                console.error('Person modal not found');
            }
        }

        function closePersonModal() {
            const modal = document.getElementById('personModal');
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
            }
        }

        function loadPersonList() {
            const container = document.getElementById('personListContainer');
            if (!container) return;

            let html = '<div class="person-list">';
            persons.forEach(person => {
                html += `
                    <div class="person-item">
                        <div>
                            <div class="person-name">${person.name}</div>
                            <div class="person-email">${person.email || 'E-posta yok'}</div>
                            <div class="person-team">${getTeamDisplayName(person.team)}</div>
                        </div>
                        <div class="person-actions">
                            <button class="btn danger" onclick="deletePerson('${person.id}')">Sil</button>
                        </div>
                    </div>
                `;
            });
            html += '</div>';

            container.innerHTML = html;
        }

        async function addPerson() {
            const name = document.getElementById('personName').value.trim();
            const email = document.getElementById('personEmail').value.trim();
            const team = document.getElementById('personTeam').value;

            if (!name || !team) {
                showToast('ƒ∞sim ve takƒ±m alanlarƒ± gereklidir!', 'error');
                return;
            }

            try {
                await addDoc(collection(db, 'persons'), {
                    name,
                    email,
                    team,
                    createdAt: new Date()
                });

                document.getElementById('addPersonForm').reset();
                await loadPersons();
                loadPersonList();
                updatePersonOptions();
                showToast('Ki≈üi ba≈üarƒ±yla eklendi!', 'success');
            } catch (error) {
                console.error('Error adding person:', error);
                showToast('Ki≈üi eklenirken hata olu≈ütu!', 'error');
            }
        }

        async function deletePerson(personId) {
            if (!confirm('Bu ki≈üiyi silmek istediƒüinizden emin misiniz?')) return;

            try {
                await deleteDoc(doc(db, 'persons', personId));
                await loadPersons();
                loadPersonList();
                updatePersonOptions();
                showToast('Ki≈üi ba≈üarƒ±yla silindi!', 'success');
            } catch (error) {
                console.error('Error deleting person:', error);
                showToast('Ki≈üi silinirken hata olu≈ütu!', 'error');
            }
        }

        function updatePersonOptions() {
            const personSelect = document.getElementById('actionPerson');
            const selectedTeam = document.getElementById('actionResponsible').value;

            personSelect.innerHTML = '<option value="">Se√ßiniz</option>';

            const teamPersons = persons.filter(p => p.team === selectedTeam);
            teamPersons.forEach(person => {
                const option = document.createElement('option');
                option.value = person.id;
                option.textContent = person.name;
                personSelect.appendChild(option);
            });
        }

        // Add event listener for team change
        document.addEventListener('DOMContentLoaded', function() {
            const responsibleSelect = document.getElementById('actionResponsible');
            if (responsibleSelect) {
                responsibleSelect.addEventListener('change', updatePersonOptions);
            }
        });

        // Modal Outside Click Functions
        function closeModalOnOutsideClick(event) {
            const activeModal = event.target;
            if (activeModal.classList.contains('modal') && activeModal.classList.contains('active')) {
                if (event.target === activeModal) {
                    // Close the active modal
                    activeModal.classList.remove('active');
                    activeModal.style.display = 'none';

                    // Reset any form data if needed
                    if (activeModal.id === 'actionModal') {
                        editingId = null;
                    } else if (activeModal.id === 'postponeModal') {
                        postponingId = null;
                    }
                }
            }
        }

        // Global click handler for closing modals
        document.addEventListener('click', function(e) {
            const activeModal = document.querySelector('.modal.active');
            if (activeModal && e.target === activeModal) {
                 activeModal.classList.remove('active');
                 activeModal.style.display = 'none';
            }
        });

        // Data Loading Functions
        async function loadActions() {
            try {
                const q = query(collection(db, 'actions'), orderBy('createdAt', 'desc'));
                const querySnapshot = await getDocs(q);
                actions = [];
                querySnapshot.forEach((doc) => {
                    actions.push({ id: doc.id, ...doc.data() });
                });
                updateStatistics();
                filterActions();
            } catch (error) {
                console.error('Error loading actions:', error);
                showToast('Aksiyonlar y√ºklenirken hata olu≈ütu!', 'error');
            }
        }

        async function loadPersons() {
            try {
                const querySnapshot = await getDocs(collection(db, 'persons'));
                persons = [];
                querySnapshot.forEach((doc) => {
                    persons.push({ id: doc.id, ...doc.data() });
                });
                updatePersonOptions();
            } catch (error) {
                console.error('Error loading persons:', error);
            }
        }

        // Export Functions
        function exportToExcel() {
            try {
                const filteredActions = getFilteredActions();
                const data = filteredActions.map(action => ({
                    'Ba≈ülƒ±k': action.title,
                    'Sorumlu Takƒ±m': getTeamDisplayName(action.responsible),
                    'Ki≈üi': getPersonName(action.person) || 'Belirtilmemi≈ü',
                    'Durum': getStatusText(action.status),
                    'Hedef Tarih': action.date ? formatDate(action.date) : 'Belirtilmemi≈ü',
                    'A√ßƒ±klama': action.description || 'A√ßƒ±klama yok',
                    '√ñncelikli': action.priority ? 'Evet' : 'Hayƒ±r',
                    'Ertelenmi≈ü': action.postponed ? 'Evet' : 'Hayƒ±r',
                    'Erteleme Notu': action.postponeReason || ''
                }));

                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.json_to_sheet(data);
                XLSX.utils.book_append_sheet(wb, ws, "Aksiyonlar");
                XLSX.writeFile(wb, `Aksiyon_Takip_${new Date().toISOString().split('T')[0]}.xlsx`);
                showToast('Excel dosyasƒ± ba≈üarƒ±yla indirildi!', 'success');
            } catch (error) {
                console.error('Excel export error:', error);
                showToast('Excel dƒ±≈üa aktarma hatasƒ±!', 'error');
            }
        }

        function exportToWord() {
            try {
                const filteredActions = getFilteredActions();
                const anadoluActions = filteredActions.filter(a => a.responsible === 'anadolu');
                const aifteamActions = filteredActions.filter(a => a.responsible === 'aifteam');
                const ortakActions = filteredActions.filter(a => a.responsible === 'ortak');

                const htmlContent = `
                <html>
                <head>
                    <meta charset='utf-8'>
                    <title>Aksiyon Takip Raporu</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            margin: 20px;
                            line-height: 1.6;
                        }
                        h1 {
                            color: #2563eb;
                            text-align: center;
                            border-bottom: 3px solid #2563eb;
                            padding-bottom: 10px;
                        }
                        h2 {
                            color: #1f2937;
                            margin-top: 30px;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                        }
                        th, td {
                            border: 1px solid #ddd;
                            padding: 12px;
                            text-align: left;
                        }
                        th {
                            background-color: #f3f4f6;
                            font-weight: bold;
                        }
                        .stats-table {
                            margin: 20px 0;
                        }
                        .header-info {
                            text-align: center;
                            margin: 2cm;
                        }
                    </style>
                </head>
                <body>
                    <div class="header-info">
                        <h1>üöÄ Aksiyon Takip Sistemi Raporu</h1>
                        <p><strong>Rapor Tarihi:</strong> ${new Date().toLocaleDateString('tr-TR')}</p>
                        <p><strong>Toplam Aksiyon Sayƒ±sƒ±:</strong> ${actions.length}</p>
                    </div>

                    <h2>üìä √ñzet ƒ∞statistikler</h2>
                    <table class="stats-table">
                        <thead>
                            <tr>
                                <th>Takƒ±m</th>
                                <th>Toplam</th>
                                <th>Bekleyen</th>
                                <th>Devam Eden</th>
                                <th>Tamamlanan</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>üè¢ Anadolu Bakƒ±r</td>
                                <td>${anadoluActions.length}</td>
                                <td>${anadoluActions.filter(a => a.status === 'waiting').length}</td>
                                <td>${anadoluActions.filter(a => a.status === 'inprogress').length}</td>
                                <td>${anadoluActions.filter(a => a.status === 'completed').length}</td>
                            </tr>
                            <tr>
                                <td>üíª AIFTEAM</td>
                                <td>${aifteamActions.length}</td>
                                <td>${aifteamActions.filter(a => a.status === 'waiting').length}</td>
                                <td>${aifteamActions.filter(a => a.status === 'inprogress').length}</td>
                                <td>${aifteamActions.filter(a => a.status === 'completed').length}</td>
                            </tr>
                            <tr>
                                <td>ü§ù Ortak Aksiyonlar</td>
                                <td>${ortakActions.length}</td>
                                <td>${ortakActions.filter(a => a.status === 'waiting').length}</td>
                                <td>${ortakActions.filter(a => a.status === 'inprogress').length}</td>
                                <td>${ortakActions.filter(a => a.status === 'completed').length}</td>
                            </tr>
                            <tr style="font-weight: bold; background-color: #ecf0f1;">
                                <td>TOPLAM</td>
                                <td>${actions.length}</td>
                                <td>${actions.filter(a => a.status === 'waiting').length}</td>
                                <td>${actions.filter(a => a.status === 'inprogress').length}</td>
                                <td>${actions.filter(a => a.status === 'completed').length}</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2>üìã Detaylƒ± Aksiyon Listesi</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Ba≈ülƒ±k</th>
                                <th>Sorumlu Takƒ±m</th>
                                <th>Ki≈üi</th>
                                <th>Durum</th>
                                <th>Hedef Tarih</th>
                                <th>A√ßƒ±klama</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredActions.map(action => `
                                <tr>
                                    <td>${action.priority ? '‚≠ê ' : ''}${action.title}</td>
                                    <td>${getTeamDisplayName(action.responsible)}</td>
                                    <td>${getPersonName(action.person) || 'Belirtilmemi≈ü'}</td>
                                    <td>${getStatusText(action.status)}</td>
                                    <td>${action.date ? formatDate(action.date) : 'Belirtilmemi≈ü'}</td>
                                    <td>${action.description || 'A√ßƒ±klama yok'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
                `;

                const blob = htmlDocx.asBlob(htmlContent);
                saveAs(blob, `Aksiyon_Takip_Raporu_${new Date().toISOString().split('T')[0]}.docx`);
                showToast('Word dosyasƒ± ba≈üarƒ±yla indirildi!', 'success');
            } catch (error) {
                console.error('Word export error:', error);
                showToast('Word dƒ±≈üa aktarma hatasƒ±!', 'error');
            }
        }

        // Action CRUD Functions
        async function saveAction() {
            const title = document.getElementById('actionTitle').value.trim();
            const responsible = document.getElementById('actionResponsible').value;
            const person = document.getElementById('actionPerson').value;
            const date = document.getElementById('actionDate').value;
            const description = document.getElementById('actionDescription').value.trim();
            const status = document.getElementById('actionStatus').value;
            const priority = document.getElementById('actionPriority').checked;

            if (!title || !responsible || !date) {
                showToast('L√ºtfen zorunlu alanlarƒ± doldurun!', 'error');
                return;
            }

            const actionData = {
                title,
                responsible,
                person,
                date,
                description,
                status,
                priority,
                postponed: false,
                postponeReason: '',
                updatedAt: new Date()
            };

            try {
                if (editingId) {
                    const actionRef = doc(db, 'actions', editingId);
                    await updateDoc(actionRef, actionData);
                    showToast('Aksiyon ba≈üarƒ±yla g√ºncellendi!', 'success');
                } else {
                    actionData.createdAt = new Date();
                    await addDoc(collection(db, 'actions'), actionData);
                    showToast('Aksiyon ba≈üarƒ±yla eklendi!', 'success');
                }

                closeModal();
                await loadActions();
            } catch (error) {
                console.error('Error saving action:', error);
                showToast('Aksiyon kaydedilirken hata olu≈ütu!', 'error');
            }
        }

        async function deleteAction(actionId) {
            try {
                await deleteDoc(doc(db, 'actions', actionId));
                await loadActions();
                showToast('Aksiyon ba≈üarƒ±yla silindi!', 'success');
            } catch (error) {
                console.error('Error deleting action:', error);
                showToast('Aksiyon silinirken hata olu≈ütu!', 'error');
            }
        }

        async function postponeAction(actionId, reason) {
            try {
                const actionRef = doc(db, 'actions', actionId);
                await updateDoc(actionRef, {
                    postponed: true,
                    postponeReason: reason,
                    updatedAt: new Date()
                });

                await loadActions();
                showToast('Aksiyon ertelendi!', 'info');
            } catch (error) {
                console.error('Error postponing action:', error);
                showToast('Aksiyon ertelenirken hata olu≈ütu!', 'error');
            }
        }

        // Filter Functions
        function getFilteredActions() {
            let filtered = [...actions];

            if (activeFilters.team) {
                filtered = filtered.filter(action => action.responsible === activeFilters.team);
            }

            if (activeFilters.status) {
                filtered = filtered.filter(action => action.status === activeFilters.status);
            }

            if (activeFilters.priority) {
                filtered = filtered.filter(action => action.priority === true);
            }

            // Sort by date
            filtered.sort((a, b) => {
                if (!a.date && !b.date) return 0;
                if (!a.date) return 1;
                if (!b.date) return -1;

                const dateA = new Date(a.date);
                const dateB = new Date(b.date);

                return activeFilters.dateSort === 'asc' ? dateA - dateB : dateB - dateA;
            });

            return filtered;
        }

        function filterActions() {
            const teamFilter = document.getElementById('teamFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const dateSort = document.getElementById('dateFilter').value;

            activeFilters.team = teamFilter;
            activeFilters.status = statusFilter;
            activeFilters.dateSort = dateSort;

            switchView(currentView);
        }

        function togglePriorityFilter() {
            const btn = document.getElementById('priorityFilterBtn');
            activeFilters.priority = !activeFilters.priority;

            if (activeFilters.priority) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }

            switchView(currentView);
        }

        // Statistics Functions
        function updateStatistics() {
            const anadoluActions = actions.filter(a => a.responsible === 'anadolu');
            const aifteamActions = actions.filter(a => a.responsible === 'aifteam');
            const ortakActions = actions.filter(a => a.responsible === 'ortak');

            // Anadolu Bakƒ±r stats
            document.getElementById('anadoluTotal').textContent = anadoluActions.length;
            document.getElementById('anadoluWaiting').textContent = anadoluActions.filter(a => a.status === 'waiting').length;
            document.getElementById('anadoluInProgress').textContent = anadoluActions.filter(a => a.status === 'inprogress').length;
            document.getElementById('anadoluCompleted').textContent = anadoluActions.filter(a => a.status === 'completed').length;

            // AIFTEAM stats
            document.getElementById('aifteamTotal').textContent = aifteamActions.length;
            document.getElementById('aifteamWaiting').textContent = aifteamActions.filter(a => a.status === 'waiting').length;
            document.getElementById('aifteamInProgress').textContent = aifteamActions.filter(a => a.status === 'inprogress').length;
            document.getElementById('aifteamCompleted').textContent = aifteamActions.filter(a => a.status === 'completed').length;

            // Ortak stats
            document.getElementById('ortakTotal').textContent = ortakActions.length;
            document.getElementById('ortakWaiting').textContent = ortakActions.filter(a => a.status === 'waiting').length;
            document.getElementById('ortakInProgress').textContent = ortakActions.filter(a => a.status === 'inprogress').length;
            document.getElementById('ortakCompleted').textContent = ortakActions.filter(a => a.status === 'completed').length;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default for new actions
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('actionDate').value = today;
        });
    </script>
</body>
</html>