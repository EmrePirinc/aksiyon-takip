<div class="modal-content modal-content-scrollable" style="max-width: 900px; max-height: 90vh;"><div class="modal-header"><h2 id="detailTitle">Aksiyon Detayları</h2><div style="margin-left: auto; display: flex; gap: 8px;"><button type="button" class="btn btn-icon" id="editToggleBtn" onclick="toggleEditMode()" style="display: block; padding: 8px 16px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 6px; display: flex; align-items: center; gap: 6px; font-size: 14px; color: #495057; transition: all 0.2s;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="m18.5 2.5-3 3L12 9l-4 1 1-4 3.5-3.5a2.121 2.121 0 0 1 3 3z"/></svg>Düzenle</button><button type="button" class="btn btn-primary" id="saveBtn" onclick="saveComprehensiveEdit()" style="display: none; padding: 8px 16px; background: #007bff; border: 1px solid #007bff; border-radius: 6px; display: flex; align-items: center; gap: 6px; font-size: 14px; color: white; transition: all 0.2s;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17,21 17,13 7,13 7,21"/><polyline points="7,3 7,8 15,8"/></svg>Kaydet</button><button type="button" class="btn btn-icon" onclick="closeDetailModal()" style="padding: 8px; background: transparent; border: none; border-radius: 6px; color: #6c757d; transition: all 0.2s;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button></div></div><!-- Detail View (Read-only) --><div id="detailViewForm" style="display: block;"><div class="detail-card-grid" style="display: grid; gap: 16px;"><!-- Title and Priority Row --><div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #007bff;"><div><h3 id="viewActionTitle" style="margin: 0; font-size: 18px; font-weight: 600; color: #212529;"></h3></div><div id="viewActionPriority" style="display: flex; align-items: center; gap: 6px; font-size: 14px; color: #6c757d;"></div></div><!-- Status and Date Row --><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;"><div style="padding: 12px; background: white; border: 1px solid #e9ecef; border-radius: 6px;"><div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">Durum</div><span id="viewActionStatus" class="status-badge" style="font-size: 14px; font-weight: 500;"></span></div><div style="padding: 12px; background: white; border: 1px solid #e9ecef; border-radius: 6px;"><div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">Hedef Tarih</div><span id="viewActionDate" style="font-size: 14px; font-weight: 500; color: #212529;"></span></div></div><!-- People Row --><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;"><div style="padding: 12px; background: white; border: 1px solid #e9ecef; border-radius: 6px;"><div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">Sorumlu</div><span id="viewActionResponsible" style="font-size: 14px; font-weight: 500; color: #212529;"></span></div><div style="padding: 12px; background: white; border: 1px solid #e9ecef; border-radius: 6px;"><div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;">Atanan Kişi</div><span id="viewActionAssignedPerson" style="font-size: 14px; font-weight: 500; color: #212529;"></span></div></div><!-- Description --><div style="padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 6px;"><div style="font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;">Açıklama</div><div id="viewActionDescription" style="font-size: 14px; line-height: 1.5; color: #212529;"></div></div></div></div><!-- Edit Form --><form id="detailEditForm" style="display: none;"><div style="display: grid; gap: 20px;"><!-- Title and Priority Row --><div style="display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: end;"><div class="form-group" style="margin: 0;"><label for="editActionTitle" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Başlık *</label><input type="text" id="editActionTitle" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; transition: border-color 0.2s; background: white;"></div><div class="form-group" style="margin: 0;"><label class="priority-toggle" style="display: flex; align-items: center; gap: 8px; cursor: pointer; user-select: none; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 6px; background: white; transition: all 0.2s;"><input type="checkbox" id="editActionPriority" style="display: none;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #f59e0b;"><polygon points="12 2 22 8.5 17 20.5 7 20.5 2 8.5"/></svg><span style="font-size: 14px; font-weight: 500; color: #374151;">Öncelikli</span></label></div></div><!-- People Row --><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;"><div class="form-group" style="margin: 0;"><label for="editActionResponsible" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Sorumlu *</label><select id="editActionResponsible" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; background: white; cursor: pointer;"><option value="">Sorumlu Seç</option><option value="Anadolu Bakır">Anadolu Bakır</option><option value="AIFTEAM">AIFTEAM</option></select></div><div class="form-group" style="margin: 0;"><label for="editActionAssignedPerson" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Atanan Kişi</label><select id="editActionAssignedPerson" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; background: white; cursor: pointer;"><option value="">Kişi seçilmedi</option></select></div></div><!-- Status and Date Row --><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;"><div class="form-group" style="margin: 0;"><label for="editActionStatus" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Durum *</label><select id="editActionStatus" required style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; background: white; cursor: pointer;"><option value="waiting">Bekliyor</option><option value="in-progress">Devam Ediyor</option><option value="completed">Tamamlandı</option></select></div><div class="form-group" style="margin: 0;"><label for="editActionDate" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Hedef Tarih</label><input type="date" id="editActionDate" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; background: white;"></div></div><!-- Description --><div class="form-group" style="margin: 0;"><label for="editActionDescription" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Açıklama</label><textarea id="editActionDescription" rows="4" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; resize: vertical; background: white; line-height: 1.5;"></textarea></div></div><!-- File Upload Section --><div class="form-group" style="margin-top: 20px;"><label for="editActionFiles" style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 6px; display: block;">Dosya Ekle</label><div style="border: 2px dashed #d1d5db; border-radius: 8px; padding: 20px; text-align: center; background: #f9fafb; transition: border-color 0.2s;"><input type="file" id="editActionFiles" multiple accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt" style="display: none;"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #9ca3af; margin-bottom: 8px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7,10 12,15 17,10"/><line x1="12" y1="15" x2="12" y2="3"/></svg><div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">Dosyaları buraya sürükleyin veya</div><button type="button" onclick="document.getElementById('editActionFiles').click()" style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 14px; cursor: pointer; transition: background-color 0.2s;">Dosya Seç</button><div style="font-size: 12px; color: #9ca3af; margin-top: 8px;">PDF, Word, Excel, PowerPoint, Resim dosyaları</div></div><div id="editActionFilePreview" class="file-preview-container" style="margin-top: 12px; display: grid; gap: 8px;"><!-- Uploaded files will appear here --></div></div></form><!-- Attachments Section --><div id="detailAttachments" class="detail-section" style="display: none;"><div class="detail-label" style="margin-bottom: 8px;">📎 Ekler</div><div id="detailAttachmentsList" class="attachment-list"></div></div><!-- Notes Section --><div id="detailNotes" class="detail-section" style="display: none;"><div class="detail-label" style="margin-bottom: 8px;">📝 Notlar</div><div id="detailNotesList"></div></div><!-- Not Ekleme Formu --><div id="inlineNoteForm" style="display: none; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;"><h3 style="margin-bottom: 15px; color: #495057;">📝 Not Ekle</h3><div class="form-group"><label for="inlineNoteType">Tip *</label><select id="inlineNoteType" required><option value="">Tip Seç</option><option value="postpone">Erteleme</option><option value="note">Not</option><option value="update">Güncelleme</option><option value="reminder">Hatırlatma</option></select></div><div class="form-group"><label for="inlineNoteColor">Renk</label><div class="color-picker"><input type="color" id="inlineNoteColor" value="#3498db"><div class="color-presets"><button type="button" class="color-preset" data-color="#3498db" style="background: #3498db" onclick="setInlineNoteColor('#3498db')"></button><button type="button" class="color-preset" data-color="#e74c3c" style="background: #e74c3c" onclick="setInlineNoteColor('#e74c3c')"></button><button type="button" class="color-preset" data-color="#f39c12" style="background: #f39c12" onclick="setInlineNoteColor('#f39c12')"></button><button type="button" class="color-preset" data-color="#2ecc71" style="background: #2ecc71" onclick="setInlineNoteColor('#2ecc71')"></button><button type="button" class="color-preset" data-color="#9b59b6" style="background: #9b59b6" onclick="setInlineNoteColor('#9b59b6')"></button><button type="button" class="color-preset" data-color="#95a5a6" style="background: #95a5a6" onclick="setInlineNoteColor('#95a5a6')"></button></div></div></div><div class="form-group"><label for="inlineNoteText">Açıklama *</label><textarea id="inlineNoteText" required placeholder="Açıklama girin..." rows="4"></textarea></div><div class="form-group" id="inlinePostponeDateGroup" style="display: none;"><label for="inlineNotePostponeDate">Yeni Hedef Tarih *</label><input type="date" id="inlineNotePostponeDate"></div><div class="form-group"><label for="inlineNoteImages">Resim Ekle</label><input type="file" id="inlineNoteImages" multiple accept="image/*"><div id="inlineImagePreview" class="image-preview"></div></div><div style="display: flex; gap: 10px; margin-top: 15px;"><button type="button" class="btn btn-primary" onclick="saveInlineNote()">✅ Ekle</button><button type="button" class="btn btn-secondary" onclick="toggleInlineNoteForm()">❌ İptal</button></div></div><div class="modal-buttons" style="margin-top: 30px;"><button type="button" class="btn modal-btn cancel" onclick="closeDetailModal()">Kapat</button></div></div></div><!-- Backup Settings Modal --><div class="modal" id="backupModal"><div class="modal-content"><div class="modal-header"><h2>Yedekleme Ayarları</h2></div><div style="margin-bottom: 20px;"><p>Verilerinizi güvenle yedekleyebilir ve geri yükleyebilirsiniz.</p></div><div style="display: flex; gap: 15px; flex-wrap: wrap;"><button type="button" class="btn btn-success" onclick="exportAllData()" style="flex: 1; min-width: 200px;">📁 Verileri Dışa Aktar (JSON)</button><button type="button" class="btn btn-primary" onclick="document.getElementById('importFile').click()" style="flex: 1; min-width: 200px;">📂 Verileri İçe Aktar</button></div><input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)"><div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 6px; border-left: 4px solid #ffc107;"><strong>⚠️ Dikkat:</strong> Veri içe aktarımı mevcut tüm verilerin üzerine yazacaktır. Bu işlemden önce mevcut verilerinizi yedeklediğinizden emin olun.</div><div class="modal-buttons" style="margin-top: 25px;"><button type="button" class="btn modal-btn cancel" onclick="closeBackupModal()">Kapat</button></div></div></div><!-- Postpone Modal --><div class="modal" id="postponeModal"><div class="modal-content"><div class="modal-header"><h2>⏰ Görevi Ertele</h2></div><form id="postponeForm"><div class="form-group"><label for="postponeReason">Erteleme Sebebi *</label><textarea id="postponeReason" required placeholder="Erteleme sebebini açıklayın..."></textarea></div><div class="form-group"><label for="postponeDate">Yeni Hedef Tarih *</label><input type="date" id="postponeDate" required></div><div class="form-group"><label for="postponePriority">Öncelik Durumu</label><select id="postponePriority"><option value="normal">Normal</option><option value="high">Yüksek Öncelik</option><option value="urgent">Acil</option></select></div><div class="form-group"><label for="postponeColor">Renk</label><div class="color-picker"><input type="color" id="postponeColor" value="#7c3aed"><div class="color-presets"><button type="button" class="color-preset" data-color="#7c3aed" style="background: #7c3aed"></button><button type="button" class="color-preset" data-color="#f39c12" style="background: #f39c12"></button><button type="button" class="color-preset" data-color="#e74c3c" style="background: #e74c3c"></button><button type="button" class="color-preset" data-color="#2ecc71" style="background: #2ecc71"></button><button type="button" class="color-preset" data-color="#9b59b6" style="background: #9b59b6"></button><button type="button" class="color-preset" data-color="#95a5a6" style="background: #95a5a6"></button></div></div></div><div class="form-group"><label for="postponeImages">Resim Ekle</label><input type="file" id="postponeImages" multiple accept="image/*"><div id="postponeImagePreview" class="image-preview"></div></div><div class="modal-buttons"><button type="button" class="modal-btn cancel" onclick="closePostponeModal()">İptal</button><button type="submit" class="modal-btn save">⏰ Ertele</button></div></form></div></div><!-- Image Modal --><div id="imageModal" class="image-modal" onclick="closeImageModal()" style="display: none;"><div class="image-container" onclick="event.stopPropagation()"><img id="modalImage" src="" alt="" draggable="false"><div class="zoom-controls"><button class="zoom-btn" onclick="zoomIn()">+</button><button class="zoom-btn" onclick="resetZoom()">⌂</button><button class="zoom-btn" onclick="zoomOut()">−</button></div></div><button class="close-modal" onclick="closeImageModal()">×</button>